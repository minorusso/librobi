<div class="jumbotron">
    <% if user_signed_in? && @user == current_user %>
        <h1 class="display-4">マイページ</h1>
    <% else %>
        <h1 class="display-4"><%= @user.name %>さんのページ</h1>
    <% end %>
    <hr class="my-4">
    <%= link_to "タイムライン", posts_path, class: "btn btn-warning btn-lg text-white" %>
</div>
<div class="container">
    <div class="d-flex border justify-content-center">
        <% if user_signed_in? && @user == current_user %>
            <%= link_to "プロフィール編集", edit_user_path(@user), class: "btn-sm btn-success" %><br>
        <% end %>
    </div> 
    <%= attachment_image_tag @user, :profile_image, :fill, 70, 70, format: 'jpeg', fallback: "no_profile_image.png", class: "mb-3 profile-img" %><br>
    <h4><%= @user.profile %></h4>
    <% if current_user != @user %>
        <% if current_user.following?(@user) %>
        <%= link_to 'フォロー外す', user_relationships_path(@user.id), method: :delete, class: "btn-sm btn-danger" %>
        <% else %>
        <%= link_to 'フォローする', user_relationships_path(@user.id), method: :POST, class:"btn-sm btn-success" %>
        <% end %>
    <% end %>
    <%= link_to follows_user_path(@user) do %>
        <h6>フォロー<%= @following_users.count %></h6>
    <% end %>&nbsp;&nbsp;
    <%= link_to followers_user_path(@user) do %>
        <h6>フォロワー<%= @follower_users.count %></h6>
    <% end %>
    <div class="d-flex border justify-content-center">
            <h1 class="font-weight-normal mt-5 mb-5">これまでのレビュー</h1> 
        </div> 
    <div class="content">
        <div class="card-wrap">    
            <% @posts.each do |post| %>
            <div class="card-list">
                <p class="book-image"><%= link_to (image_tag(post.book.image_url)), post.book.url %></p>
                <p class="book-title"><%= post.book.title %></p><br>
                <div id="star-rate-<%= post.id %>"></div>
                <script>
                $('#star-rate-<%= post.id %>').raty({
                    size: 36,
                    starOff:  '<%= asset_path('star-off.png') %>',
                    starOn : '<%= asset_path('star-on.png') %>',
                    starHalf: '<%= asset_path('star-half.png') %>',
                    half: true,
                    readOnly: true,
                    score: <%= post.rate %>,
                });
                </script>  
                <!--/星評価-->
                <p class="review"><%= post.review %></td><br>
                <div id="favorite_btn_<%= post.id %>">
                    <%= render 'favorites/favorite', post: post %>
                </div>
                <td><%= "#{post.comments.count} コメント" %></td>   
                <td><%= link_to "詳細", post_path(id: post.id, book_id: post.book.id ),  class: "btn btn-success" %></td> 
            </div>
            <% end %>
        </div>
    </div>              
    <%= paginate @posts %>
</div>
